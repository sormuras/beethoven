configurations {
    format
}

dependencies {
    format "com.google.googlejavaformat:google-java-format:1.2-SNAPSHOT"
}

task downloadFormat(type: Copy) {
    from configurations.format
    into "$buildDir/format"
}

task runFormat(type: JavaExec) {
    classpath = fileTree(dir: "$buildDir/format", include: '*.jar')

    main 'com.google.googlejavaformat.java.Main'

    args += '--replace'
    args += sourceSets.main.allJava.files
    args += sourceSets.test.allJava.files
}

runFormat.dependsOn downloadFormat
